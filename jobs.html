<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8"/>
  <title>豎ゆｺｺ諠・ｱ</title>
  <style>
    .match-3 { background: #f88; }
    .match-2 { background: #ff8; }
    .match-1 { background: #8f8; }
    table { width: 100%; border-collapse: collapse; }
    th, td { border: 1px solid #ccc; padding: 0.5em; }
  </style>
</head>
<body>
  <h1>豎ゆｺｺ諠・ｱ</h1>
  <label>繧ｭ繝ｼ繝ｯ繝ｼ繝会ｼ医き繝ｳ繝槫玄蛻・ｊ縺ｧ譛螟ｧ3縺､・会ｼ・
    <input id="keywords" type="text" placeholder="萓具ｼ壽擲莠ｬ,譛ｪ邨碁ｨ・鬮伜庶蜈･">
  </label>
  <button onclick="applyFilter()">繝輔ぅ繝ｫ繧ｿ繝ｼ驕ｩ逕ｨ</button>
  
  <div id="jobs"></div>
  
  <script>
    let jobData = [];
    fetch('jobData.json')
      .then(r => r.json())
      .then(d => { jobData = d; renderTable(d); });

    function applyFilter() {
      const kw = document.getElementById('keywords').value
        .split(',')
        .map(s => s.trim())
        .filter(s => s);
      if (kw.length === 0) {
        renderTable(jobData);
        return;
      }
      const filtered = jobData.map(job => {
        const text = `${job.title} ${job.company} ${job.location} ${job.salary} ${job.note}`;
        // 譁・ｭ怜・縺ｫ繧ｭ繝ｼ繝ｯ繝ｼ繝峨′蜷ｫ縺ｾ繧後ｋ縺九き繧ｦ繝ｳ繝茨ｼ・oolean縺ｪ縺ｮ縺ｧ + 縺ｯ雜ｳ縺礼ｮ励↓縺ｪ繧具ｼ・
        const matches = kw.reduce((count, k) => count + (text.includes(k) ? 1 : 0), 0);
        return { ...job, matches };
      }).filter(j => j.matches > 0)
        .sort((a,b) => b.matches - a.matches);
      renderTable(filtered);
    }

    function renderTable(data) {
      const div = document.getElementById('jobs');
      if (!data.length) {
        div.innerHTML = '<p>隧ｲ蠖捺ｱゆｺｺ縺ｪ縺・/p>';
        return;
      }
      let html = '<table><tr><th>繧ｿ繧､繝医Ν</th><th>莨夂､ｾ</th><th>蜍､蜍吝慍</th><th>邨ｦ荳・/th><th>蛯呵・/th></tr>';
      for (const job of data) {
        const cls = `match-${job.matches}`;
        html += `<tr class="${cls}">
          <td>${job.title}</td>
          <td>${job.company}</td>
          <td>${job.location}</td>
          <td>${job.salary}</td>
          <td>${job.note}</td>
        </tr>`;
      }
      html += '</table>';
      div.innerHTML = html;
    }
  </script>
</body>
</html>
